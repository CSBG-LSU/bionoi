# bionoi
Conversion of biomolecules to Voronoi diagrams.

## Description
bionoi constructs the [voronoi diagram](https://en.wikipedia.org/wiki/Voronoi_diagram) (VD) of protein binding site/pocket or ligand structure based on the 3D or 2D coordinate structure.

## Requirements
1. Python 3
2. numpy 1.14+
3. scipy 0.18+
4. Pandas 0.19+
5. scikit-spatial 0.12.0
6. matplotlib 2.0.2+
7. biopandas ; eg : pip/conda install biopandas

## File description
1. extract_mols.sh: a script that extracts .mol2 files of a single direction from the origin .mol2 file folder.
2. split_folder_binary_classification.py: take the folder generated by extract_mols.sh, then generate a new folder containing .mol2 files for binary classification.
   usage: python split_folder_binary_classification.py -opMode control_vs_heme
          python split_folder_binary_classification.py -opMode control_vs_nucleotide
3. split_folder_cv: split the folder gernerated by extract_mols.sh, then gernerate a new folder containing .mol2 files to perform k-fold cross-validation for binary    classification.
   usage: python split_folder_cv.py -opMode control_vs_heme
          python split_folder_cv.py -opMode control_vs_nucleotide
4. img_gen: take the .mol2 files and generate images for each of them. User can specify options to control number of images generated for each .mol2 file.
   usage: python img_gen.py -opMode control_vs_heme -proDirect 1 -rotAngle2D 1 -flip 1
5. info_gen: generate files for finial analysis.
   usage: python info_gen.py

## Getting started

1. copy/download the code from GitHub
2. If input is a 3D coordinate of protein/ligand, it will be projected to 2D plane
3. Run voronoi.py with a .mol2 file (see Examples)

## Examples

create a 2D image using mol2 file in 2D or 3D format

    ./voronoi.py
    or
    ./voronoi.py -mol 4v94E.mol2 -out out.jpg -dpi 120 -alpha 0.5 -size 128

An example of voronoi image of ATP-binding site protein pocket colored by atom types:

![eg_image](https://github.com/rajiv03/DeepDrugV/blob/master/Voronoi_2D_4v94E.jpg)

chaperonin (4v94, chain E)

Contributors:

Rajiv Gandhi Govindaraj, Jeffrey Lemoine, Limeng Pu, Ye Fang and Michal Brylinski.
